---
title: cd on quit
description: how to make rovr change your shell's directory on quit and export selected files.
---

import { Tabs, TabItem, Code, Aside } from "@astrojs/starlight/components";

rovr can change the current directory to wherever you were when you quit using the `--cwd-file` CLI option.

### Using `--cwd-file`

The `--cwd-file` option writes the current working directory to a specified file when rovr exits:

```bash
# Create a temporary file and use it with rovr
cwd_file=$(mktemp -t rovr_cwd.XXXXXX)
rovr --cwd-file "$cwd_file"
cd "$(cat "$cwd_file")"
rm -f "$cwd_file"
```

#### shell configuration

You can create wrapper functions in your shell config for convenience:

<Tabs>
  <TabItem label="bash/zsh">
    <Code
      code={`rovr () {
    local cwd_file=$(mktemp -t rovr_cwd.XXXXXX)
    command rovr --cwd-file "$cwd_file" "$@"
    if [ -f "$cwd_file" ]; then
        local new_loc=$(cat "$cwd_file")
        if [ -n "$new_loc" ] && [ "$new_loc" != "$PWD" ]; then
            cd "$new_loc"
        fi
        rm -f "$cwd_file"
    fi
}`}
      lang="bash"
      frame="code"
      title=".bashrc / .zshrc"
    />
  </TabItem>
  <TabItem label="fish">
    <Code
      code={`function rovr
    set cwd_file (mktemp -t rovr_cwd.XXXXXX)
    command rovr --cwd-file "$cwd_file" $argv
    if test -f "$cwd_file"
        set new_loc (cat "$cwd_file")
        if test -n "$new_loc" -a "$new_loc" != "$PWD"
            cd "$new_loc"
        end
        rm -f "$cwd_file"
    end
end`}
      lang="fish"
      frame="code"
      title="config.fish"
    />
  </TabItem>
  <TabItem label="nushell">
    <Code
      code={`def --env --wrapped rovr [...args: string] {
    let cwd_file = (mktemp -t rovr_cwd.XXXXXX)
    ^rovr --cwd-file $cwd_file ...$args
    if ($cwd_file | path exists) {
        let new_path = ($cwd_file | open | str trim)
        if ($new_path != "" and $new_path != $env.PWD) {
            cd $new_path
        }
        rm -fp $cwd_file
    }
}`}
      lang="nu"
      frame="code"
      title="config.nu"
    />
  </TabItem>
  <TabItem label="powershell">
    <Code
      code={`function rovr {
    $cwd_file = New-TemporaryFile
    $rovrPath = Get-Command rovr -CommandType Application | Select-Object -ExpandProperty Source
    & $rovrPath --cwd-file $cwd_file $args
    if (Test-Path $cwd_file) {
        $new_loc = Get-Content $cwd_file
        if (-not [String]::IsNullOrEmpty($new_loc) -and $new_loc -ne (Get-Location).Path) {
            Set-Location $new_loc -ErrorAction SilentlyContinue
        }
        Remove-Item $cwd_file
    }
}`}
      lang="powershell"
      frame="code"
      title="$PROFILE"
    />
    Powershell may prevent you from running such functions, so you may have to
    run
    <Code
      code={`Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope LocalMachine`}
      lang="powershell"
    />
    for it to work. For more information on `Set-ExecutionPolicy`, refer to its
    [docs](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy)
  </TabItem>
</Tabs>

<Aside type="note">
  The shell functions above use temporary files for better security while
  avoiding conflicts.
</Aside>

### Additional CLI options

rovr also supports other Yazi-style CLI options for direct integration with scripts and tools:

#### `--chooser-file`

Write selected files to a specified file when rovr exits:

```bash
# Using a temporary file
chooser_file=$(mktemp -t rovr_selected.XXXXXX)
rovr --chooser-file "$chooser_file"
while IFS= read -r file; do
    echo "Selected: $file"
done < "$chooser_file"
rm -f "$chooser_file"
```

#### Combined usage

You can use both options together:

```bash
# Using temporary files for both options
cwd_file=$(mktemp -t rovr_cwd.XXXXXX)
chooser_file=$(mktemp -t rovr_selected.XXXXXX)
rovr --cwd-file "$cwd_file" --chooser-file "$chooser_file"

# Process results
cd "$(cat "$cwd_file")"
while IFS= read -r file; do
    echo "Selected: $file"
done < "$chooser_file"

# Clean up
rm -f "$cwd_file" "$chooser_file"
```

### `--force-tty` and `__stdout__`/`__stderr__`

<Aside type="caution">
  This may be highly unstable. Use at your own risk, lest your session be ruined.
</Aside>

If you are on Unix, or are fine losing truecolor on Windows, you can enable tty emulation with `--force-tty`, which makes rovr think it's running in a terminal even when its output is being piped.

If you combine this with something like `--cwd-file __stdout__`, rovr will write the current working directory to standard output, which you can then capture directly.

```bash
new_dir=$(rovr --force-tty --cwd-file __stdout__)
cd "$new_dir"
```
